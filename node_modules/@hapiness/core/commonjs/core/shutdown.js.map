{"version":3,"file":"shutdown.js","sourceRoot":"","sources":["../../../src/core/shutdown.ts"],"names":[],"mappings":";;AAAA,+BAA2C;AAE3C,wBAA8C;AAE9C;IAII;QACI,IAAI,CAAC,OAAO,GAAG,IAAI,cAAO,EAAE,CAAC;QAC7B,OAAO,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,EAAE;YACzB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QACH,OAAO,CAAC,IAAI,CAAC,QAAQ,EAAE,GAAG,EAAE;YACxB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAChC,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACH,QAAQ,CAAC,KAA0B;QAC/B,OAAO,iBAAU;aACZ,IAAI,CAAC,KAAK,CAAC;aACX,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,QAAQ,KAAK,4BAAyB,CAAC,SAAS,CAAC;aAC/D,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC;aACxB,OAAO,EAAE;aACT,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,iBAAU;aACrB,IAAI,CAAC,KAAK,CAAC;aACX,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,QAAQ,KAAK,4BAAyB,CAAC,MAAM,CAAC;aAC9D,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,QAAQ,CAAC;aAC1B,OAAO,EAAE,CACb;aACA,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;IACxB,CAAC;CAEJ;AAnCD,sCAmCC","sourcesContent":["import { Subject, Observable } from 'rxjs';\nimport { ExtensionShutdown } from './interfaces';\nimport { ExtensionShutdownPriority } from '.';\n\nexport class ShutdownUtils {\n\n    public events$: Subject<string>;\n\n    constructor() {\n        this.events$ = new Subject();\n        process.once('SIGTERM', () => {\n            this.events$.next('SIGTERM');\n        });\n        process.once('SIGINT', () => {\n            this.events$.next('SIGINT');\n        });\n    }\n\n    /**\n     * Shutdown all extensions\n     *\n     * @param  {ExtensionShutdown[]} items\n     * @returns Observable\n     */\n    shutdown(items: ExtensionShutdown[]): Observable<boolean> {\n        return Observable\n            .from(items)\n            .filter(_ => _.priority === ExtensionShutdownPriority.IMPORTANT)\n            .flatMap(_ => _.resolver)\n            .toArray()\n            .concatMap(_ => Observable\n                .from(items)\n                .filter(__ => __.priority === ExtensionShutdownPriority.NORMAL)\n                .flatMap(__ => __.resolver)\n                .toArray()\n            )\n            .map(_ => true);\n    }\n\n}\n"]}